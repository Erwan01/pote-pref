<script>
const noBtn = document.getElementById("noBtn");
const yesBtn = document.getElementById("yesBtn");
const counter = document.getElementById("counter");
const subtext = document.getElementById("subtext");
const arrow = document.getElementById("arrow");
const box = document.getElementById("box");

let noCount = 0;
let activated = false;
let removedOnce = false;
let yesScale = 1;
let canFlee = true;

const subtexts = [
    "Sois honnÃªte.",
    "Tu hÃ©sites vraiment ?",
    "On sait tous les deux.",
    "Câ€™est gÃªnant lÃ .",
    "Tu perds ton temps.",
    "Regarde le bouton Oui.",
    "Accepte ton destin."
];

const noTexts = [
    "tâ€™es sÃ»r ðŸ¥º",
    "nan mais vraiment ?",
    "okâ€¦",
    "bon.",
    "inutile.",
    "ðŸ˜"
];

function updateUI() {
    counter.textContent = `Tentatives sur Non : ${noCount}`;
    subtext.textContent = subtexts[Math.min(noCount, subtexts.length - 1)];
}

function growYes() {
    yesScale += 0.12;
    yesBtn.style.transform = `scale(${yesScale})`;
    if (yesScale > 1.6) {
        yesBtn.style.animation = "pulse 1s infinite";
    }
}

noBtn.addEventListener("mouseenter", () => {
    if (!activated) {
        activated = true;
        noBtn.style.position = "fixed";
    }
    fleeNo();
});

noBtn.addEventListener("click", fleeNo);

function fleeNo() {
    if (!canFlee) return;
    canFlee = false;

    noCount++;
    updateUI();
    growYes();

    if (navigator.vibrate) navigator.vibrate(60);

    // Disparition UNE SEULE FOIS
    if (noCount === 4 && !removedOnce) {
        removedOnce = true;
        noBtn.style.opacity = "0";
        setTimeout(() => {
            noBtn.style.opacity = "1";
            noBtn.style.transform = "scale(0.8)";
            noBtn.textContent = "â€¦";
        }, 600);
    } else {
        const maxX = window.innerWidth - noBtn.offsetWidth;
        const maxY = window.innerHeight - noBtn.offsetHeight;

        noBtn.style.left = Math.random() * maxX + "px";
        noBtn.style.top = Math.random() * maxY + "px";

        if (noCount <= noTexts.length) {
            noBtn.textContent = noTexts[noCount - 1];
        }
    }

    if (noCount === 3) arrow.style.display = "block";

    // Cooldown anti-chaos
    setTimeout(() => {
        canFlee = true;
    }, 300);
}

// Bouton OUI (inchangÃ© et FIABLE)
yesBtn.addEventListener("click", () => {
    document.getElementById("buttons").style.display = "none";
    document.getElementById("loading").style.display = "block";
    document.getElementById("loading").style.width = "0";

    let p = 0;
    const i = setInterval(() => {
        p++;
        document.getElementById("loading").style.width = p + "%";
        if (p >= 100) {
            clearInterval(i);
            document.getElementById("loading").style.display = "none";
            document.getElementById("title").textContent = "OUAIS ! Je le savais ðŸ¥³ðŸ¥³";
            launchConfetti();
        }
    }, 30);
});

function launchConfetti() {
    for (let i = 0; i < 80; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random() * window.innerWidth + "px";
        c.style.background = `hsl(${Math.random()*360},80%,60%)`;
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 4000);
    }
}
</script>
